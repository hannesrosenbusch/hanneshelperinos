from hanneshelpers.surveyexport import go
import os

def test_go():
	#https://admin.appinio.com/#/survey/624484e6952d8c0013dd8557/quotations
	inp = ['{"_id":"624484e6952d8c0013dd8557","active":false,"approved":true,"profilePriority":0,"finished":false,"shuffleBlocks":false,"tracking":false,"userCounter":49,"languageGroups":["en"],"filterExits":[],"sample":"none","skipSum":0,"surveyMonkeyIds":[],"withWebapp":false,"surveyType":"surveyAdmin","quotation":[{"conditionsGeneralSnapshot":{"age":[{"min":14,"max":99}],"gender":"m","countryCode":["USA"]},"maxUser":100},{"conditionsGeneralSnapshot":{"age":[{"min":14,"max":99}],"gender":"f","countryCode":["USA"]},"maxUser":100}],"enddate":"2032-03-30T00:00:00.000Z","company":"611e7f501ce2e50015a0aee3","maxParticipants":200,"startdate":"2022-03-30T16:27:18.356Z","isShortSurvey":false,"questions":[{"hideForCompany":false,"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd855a","qtype":"info","text":"Will Smith slapped Chris Rock in the face on stage at the Oscars after the comic made a joke about the actor\'s wife. Please answer the following questions.","waitingTime":3000,"filterId":"nicCVPcM","displayGroup":0,"answers":[],"rows":[],"key":[]},{"hideForCompany":false,"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd855b","qtype":"mc","text":"Did you watch the Academy Awards (AKA The Oscars) this Sunday?","answers":[{"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd855c","text":"Yes","exclusiveAnswer":false,"filterId":"QNcj8Q4T","random":false,"correctAnswer":false},{"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd855d","text":"No","exclusiveAnswer":false,"filterId":"2RZ9jx7r","random":false,"correctAnswer":false}],"allowCustomText":false,"multioptions":false,"filterId":"VlvpPRfz","displayGroup":0,"rows":[],"key":[]},{"hideForCompany":false,"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd855e","qtype":"likert","text":"Do you agree or disagree on whether Will Smith\'s act of physical aggression towards Chris Rock was justified?","filterId":"9e9b6LEg","key":[{"_id":"624484e6952d8c0013dd855f","num":1,"text":"Strongly disagree","filterId":"3EAPSdcL"},{"_id":"624484e6952d8c0013dd8560","num":2,"text":"Disagree","filterId":"APTLRyqz"},{"_id":"624484e6952d8c0013dd8561","num":3,"text":"Slightly disagree","filterId":"zXXbljr8"},{"_id":"624484e6952d8c0013dd8562","num":4,"text":"Somewhat agree","filterId":"DJaNiIGg"},{"_id":"624484e6952d8c0013dd8563","num":5,"text":"Agree","filterId":"B9diYUnp"},{"_id":"624484e6952d8c0013dd8564","num":6,"text":"Strongly agree","filterId":"1VA4hOom"}],"maxRange":6,"minRange":1,"stepRange":1,"displayGroup":0,"answers":[],"rows":[]},{"hideForCompany":false,"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd8565","qtype":"mc","text":"Do you think the Will Smith and Chris Rock confrontation was staged?","answers":[{"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd8566","text":"Yes","exclusiveAnswer":false,"filterId":"4qSJJbcA","random":false,"correctAnswer":false},{"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd8567","text":"No","exclusiveAnswer":false,"filterId":"FlojrIKo","random":false,"correctAnswer":false}],"allowCustomText":false,"multioptions":false,"filterId":"ltd351Eo","displayGroup":0,"rows":[],"key":[]},{"hideForCompany":false,"filterRequirements":[],"filterNotRequirements":[],"_id":"624484e6952d8c0013dd8568","qtype":"freetext","text":"How could have Will Smith handle the situation better?","filterId":"hvnmUoKB","displayGroup":0,"answers":[],"rows":[],"key":[]}],"title":"The Oscars Drama","date":"2022-03-30T16:27:18.388Z","approvedDate":"2022-03-30T16:27:18.409Z","webapp":null,"tags":[{"_id":"62448592f801e70009627b69","tag":"javier"}]}', False]
	go(inp)
	current_files = os.listdir()
	assert("The Oscars Drama_export.docx" in current_files)
	os.remove("The Oscars Drama_export.docx")